

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>nukernelmtd package &mdash; nukernelmtd 1.0.3 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="nukernelmtd.data package" href="nukernelmtd.data.html" />
    <link rel="prev" title="Welcome to nukernelmtd’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> nukernelmtd
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">nukernelmtd package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="nukernelmtd.data.html">nukernelmtd.data package</a></li>
<li class="toctree-l3"><a class="reference internal" href="nukernelmtd.kernel.html">nukernelmtd.kernel package</a></li>
<li class="toctree-l3"><a class="reference internal" href="nukernelmtd.metrics.html">nukernelmtd.metrics package</a></li>
<li class="toctree-l3"><a class="reference internal" href="nukernelmtd.sampling.html">nukernelmtd.sampling package</a></li>
<li class="toctree-l3"><a class="reference internal" href="nukernelmtd.utils.html">nukernelmtd.utils package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nukernelmtd.kernel_abc">nukernelmtd.kernel_abc module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nukernelmtd.kernel_mean">nukernelmtd.kernel_mean module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nukernelmtd">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">nukernelmtd</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>nukernelmtd package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/nukernelmtd.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="nukernelmtd-package">
<h1>nukernelmtd package<a class="headerlink" href="#nukernelmtd-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="nukernelmtd.data.html">nukernelmtd.data package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.data.html#module-nukernelmtd.data">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="nukernelmtd.kernel.html">nukernelmtd.kernel package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.kernel.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.kernel.html#module-nukernelmtd.kernel.gaussian_rbf">nukernelmtd.kernel.gaussian_rbf module</a></li>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.kernel.html#module-nukernelmtd.kernel.matern">nukernelmtd.kernel.matern module</a></li>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.kernel.html#module-nukernelmtd.kernel.test">nukernelmtd.kernel.test module</a></li>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.kernel.html#module-nukernelmtd.kernel">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="nukernelmtd.metrics.html">nukernelmtd.metrics package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.metrics.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.metrics.html#module-nukernelmtd.metrics.distance">nukernelmtd.metrics.distance module</a></li>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.metrics.html#module-nukernelmtd.metrics.mmd">nukernelmtd.metrics.mmd module</a></li>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.metrics.html#module-nukernelmtd.metrics">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="nukernelmtd.sampling.html">nukernelmtd.sampling package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.sampling.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="nukernelmtd.sampling.MCMC.html">nukernelmtd.sampling.MCMC package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="nukernelmtd.sampling.MCMC.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="nukernelmtd.sampling.MCMC.html#module-nukernelmtd.sampling.MCMC.hamiltonian">nukernelmtd.sampling.MCMC.hamiltonian module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nukernelmtd.sampling.MCMC.html#module-nukernelmtd.sampling.MCMC.metropolis">nukernelmtd.sampling.MCMC.metropolis module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nukernelmtd.sampling.MCMC.html#module-nukernelmtd.sampling.MCMC">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.sampling.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.sampling.html#module-nukernelmtd.sampling.kernel_herding">nukernelmtd.sampling.kernel_herding module</a></li>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.sampling.html#module-nukernelmtd.sampling">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="nukernelmtd.utils.html">nukernelmtd.utils package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.utils.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.utils.html#module-nukernelmtd.utils.band_width">nukernelmtd.utils.band_width module</a></li>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.utils.html#module-nukernelmtd.utils.pairwise">nukernelmtd.utils.pairwise module</a></li>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.utils.html#module-nukernelmtd.utils.sample_clipper">nukernelmtd.utils.sample_clipper module</a></li>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.utils.html#module-nukernelmtd.utils.transform_data">nukernelmtd.utils.transform_data module</a></li>
<li class="toctree-l2"><a class="reference internal" href="nukernelmtd.utils.html#module-nukernelmtd.utils">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-nukernelmtd.kernel_abc">
<span id="nukernelmtd-kernel-abc-module"></span><h2>nukernelmtd.kernel_abc module<a class="headerlink" href="#module-nukernelmtd.kernel_abc" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="nukernelmtd.kernel_abc.KernelABC">
<em class="property">class </em><code class="sig-prename descclassname">nukernelmtd.kernel_abc.</code><code class="sig-name descname">KernelABC</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">para</span></em>, <em class="sig-param"><span class="n">kernel</span></em>, <em class="sig-param"><span class="n">epsilon</span><span class="o">=</span><span class="default_value">0.01</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nukernelmtd.kernel_abc.KernelABC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>[summary]
The class of Kernel Mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array-like</em>) – The shape of array should be (n_samples, n_data_dim).
The output value that came out of the model.
Conditioning is done on this data. <span class="math notranslate nohighlight">\(P(para|data=obs)\)</span>.
Model parameters (para) and model outputs (data) indexes need to be aligned.</p></li>
<li><p><strong>para</strong> (<em>array-like</em>) – The shape of array should be (n_samples, n_para_dim).
Parameters used when outputting data from model.</p></li>
<li><p><strong>kernel</strong> (<em>class kernel</em>) – Specify an instance of kernel class as shown in Example.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em><em>, </em><em>optional</em>) – Regularization parameter. Defaults to 0.01.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Occurs when the number of samples of para and the number of samples of data do not match.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>[1] Fukumizu, K., Song, L., &amp; Gretton, A. (2013). Kernel Bayes’ rule: Bayesian inference with positive definite kernels. Journal of Machine Learning Research, 14, 3753–3783.
[2] Nakagome, S., Fukumizu, K., &amp; Mano, S. (2013). Kernel approximate Bayesian computation in population genetic inferences. Statistical Applications in Genetics and Molecular Biology, 12(6), 667–678. <a class="reference external" href="https://doi.org/10.1515/sagmb-2012-0050">https://doi.org/10.1515/sagmb-2012-0050</a></p>
</div>
<dl class="py method">
<dt id="nukernelmtd.kernel_abc.KernelABC.conditioning">
<code class="sig-name descname">conditioning</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nukernelmtd.kernel_abc.KernelABC.conditioning" title="Permalink to this definition">¶</a></dt>
<dd><p>[summary]
Compute conditional kernel with obs.
<span class="math notranslate nohighlight">\(m_P(para|data = obs)\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> (<em>array-like</em>) – The shape of array should be (n_samples, n_data_dim).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_abc.KernelABC.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nukernelmtd.kernel_abc.KernelABC.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_abc.KernelABC.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#nukernelmtd.kernel_abc.KernelABC.data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_abc.KernelABC.eap">
<em class="property">property </em><code class="sig-name descname">eap</code><a class="headerlink" href="#nukernelmtd.kernel_abc.KernelABC.eap" title="Permalink to this definition">¶</a></dt>
<dd><p>Expected A Posteriori
<span class="math notranslate nohighlight">\(E_{\theta|Y_{obs}}[\theta] = &lt; m_{\theta}|Y_{obs} | \cdot &gt; = \sum_i w_i \theta_i\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_abc.KernelABC.epsilon">
<em class="property">property </em><code class="sig-name descname">epsilon</code><a class="headerlink" href="#nukernelmtd.kernel_abc.KernelABC.epsilon" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_abc.KernelABC.gram">
<em class="property">property </em><code class="sig-name descname">gram</code><a class="headerlink" href="#nukernelmtd.kernel_abc.KernelABC.gram" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_abc.KernelABC.k_obs">
<em class="property">property </em><code class="sig-name descname">k_obs</code><a class="headerlink" href="#nukernelmtd.kernel_abc.KernelABC.k_obs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_abc.KernelABC.kernel">
<em class="property">property </em><code class="sig-name descname">kernel</code><a class="headerlink" href="#nukernelmtd.kernel_abc.KernelABC.kernel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_abc.KernelABC.ndata">
<em class="property">property </em><code class="sig-name descname">ndata</code><a class="headerlink" href="#nukernelmtd.kernel_abc.KernelABC.ndata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_abc.KernelABC.ndim_data">
<em class="property">property </em><code class="sig-name descname">ndim_data</code><a class="headerlink" href="#nukernelmtd.kernel_abc.KernelABC.ndim_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_abc.KernelABC.ndim_para">
<em class="property">property </em><code class="sig-name descname">ndim_para</code><a class="headerlink" href="#nukernelmtd.kernel_abc.KernelABC.ndim_para" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_abc.KernelABC.obs">
<em class="property">property </em><code class="sig-name descname">obs</code><a class="headerlink" href="#nukernelmtd.kernel_abc.KernelABC.obs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_abc.KernelABC.para">
<em class="property">property </em><code class="sig-name descname">para</code><a class="headerlink" href="#nukernelmtd.kernel_abc.KernelABC.para" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_abc.KernelABC.posterior_kernel_mean">
<code class="sig-name descname">posterior_kernel_mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kernel</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nukernelmtd.kernel_abc.KernelABC.posterior_kernel_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>[summary]
Returns the posterior kernel mean of para which is class instance of KernelMean
:param kernel: Specify an instance of kernel class.</p>
<blockquote>
<div><p>para</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the class of kernel mean</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#nukernelmtd.kernel_mean.KernelMean" title="nukernelmtd.kernel_mean.KernelMean">KernelMean</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_abc.KernelABC.weights">
<em class="property">property </em><code class="sig-name descname">weights</code><a class="headerlink" href="#nukernelmtd.kernel_abc.KernelABC.weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="nukernelmtd.kernel_abc.test">
<code class="sig-prename descclassname">nukernelmtd.kernel_abc.</code><code class="sig-name descname">test</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nukernelmtd.kernel_abc.test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-nukernelmtd.kernel_mean">
<span id="nukernelmtd-kernel-mean-module"></span><h2>nukernelmtd.kernel_mean module<a class="headerlink" href="#module-nukernelmtd.kernel_mean" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="nukernelmtd.kernel_mean.KernelMean">
<em class="property">class </em><code class="sig-prename descclassname">nukernelmtd.kernel_mean.</code><code class="sig-name descname">KernelMean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">kernel</span></em>, <em class="sig-param"><span class="n">weights</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nukernelmtd.kernel_mean.KernelMean" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>[summary]
The class of Kernel Mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array-like</em><em> or </em><em>pandas dataframe</em>) – Sample for calculating kernel mean.
An array of shape should be (n_samples_x1, n_dim).</p></li>
<li><p><strong>kernel</strong> (<em>class kernel</em>) – Specify an instance of kernel class as shown in Example.</p></li>
<li><p><strong>weights</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Defaults to None.
Weight each sample when calculating the kernel mean.
By default, all samples are treated as equal weight.
Conditional kernel mean can be obtained by specifying the weights conditioned by kernel ABC.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_gauss</span> <span class="o">=</span> <span class="n">GaussKernel</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">],[</span><span class="mf">3.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernelmean</span> <span class="o">=</span> <span class="n">KernelMean</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">kernel</span><span class="o">=</span><span class="n">kernel_gauss</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">3</span><span class="p">],[</span><span class="o">-</span><span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">kernelmean</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">array([[0.00381482],</span>
<span class="go">       [0.048816  ],</span>
<span class="go">       [0.53921322],</span>
<span class="go">       [0.58062198],</span>
<span class="go">       [0.04522482]])</span>
</pre></div>
</div>
<dl class="py method">
<dt id="nukernelmtd.kernel_mean.KernelMean.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nukernelmtd.kernel_mean.KernelMean.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_mean.KernelMean.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#nukernelmtd.kernel_mean.KernelMean.data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_mean.KernelMean.gradkde">
<code class="sig-name descname">gradkde</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">val</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nukernelmtd.kernel_mean.KernelMean.gradkde" title="Permalink to this definition">¶</a></dt>
<dd><p>compute gradient of kernel density.
:param val: ndarray of shape (n_samples_val, n_dim).
:type val: ndarray
:param **kwargs: <em>kwargs</em> is used to specify the configuration for kernel mean calculation.</p>
<blockquote>
<div><dl class="simple">
<dt>normalize (bool, optional): Defaults to False.</dt><dd><p>Specify <cite>True</cite> when normalizing the kernel.
Some kernels do not have a normalization option, so see the kernel’s docstrings.</p>
</dd>
<dt>weights_normalize (bool, optional): Defaults to False.</dt><dd><p>Specify <cite>True</cite> when normalizing kernel average weighting.</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>return gradient value tensor.
ndarray of shape (n_samples_val, n_samples_data, n_dim).
Derivative value at val of kernel centered on data. dk(x,data)/dx (x=val).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>KV (ndarray)</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – If the gradient cannot be calculated, it returns the error.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_mean.KernelMean.kde">
<code class="sig-name descname">kde</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">val</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nukernelmtd.kernel_mean.KernelMean.kde" title="Permalink to this definition">¶</a></dt>
<dd><p>compute kernel density
:param val: ndarray of shape (n_samples_val, n_dim).
:type val: ndarray
:param **kwargs: <em>kwargs</em> is used to specify the configuration for kernel mean calculation.</p>
<blockquote>
<div><dl class="simple">
<dt>normalize (bool, optional): Defaults to False.</dt><dd><p>Specify <cite>True</cite> when normalizing the kernel. Some kernels do not have a normalization option, so see the kernel’s docstrings.</p>
</dd>
<dt>weights_normalize (bool, optional): Defaults to False.</dt><dd><p>Specify <cite>True</cite> when normalizing kernel average weighting.</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>return kernel mean value. ndarray of shape (n_samples_val,n_samples_data).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>KV (ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_mean.KernelMean.kernel">
<em class="property">property </em><code class="sig-name descname">kernel</code><a class="headerlink" href="#nukernelmtd.kernel_mean.KernelMean.kernel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_mean.KernelMean.n_samples">
<em class="property">property </em><code class="sig-name descname">n_samples</code><a class="headerlink" href="#nukernelmtd.kernel_mean.KernelMean.n_samples" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.kernel_mean.KernelMean.weights">
<em class="property">property </em><code class="sig-name descname">weights</code><a class="headerlink" href="#nukernelmtd.kernel_mean.KernelMean.weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="nukernelmtd.kernel_mean.test">
<code class="sig-prename descclassname">nukernelmtd.kernel_mean.</code><code class="sig-name descname">test</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nukernelmtd.kernel_mean.test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-nukernelmtd">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-nukernelmtd" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="nukernelmtd.KernelABC">
<em class="property">class </em><code class="sig-prename descclassname">nukernelmtd.</code><code class="sig-name descname">KernelABC</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">para</span></em>, <em class="sig-param"><span class="n">kernel</span></em>, <em class="sig-param"><span class="n">epsilon</span><span class="o">=</span><span class="default_value">0.01</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nukernelmtd.KernelABC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>[summary]
The class of Kernel Mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array-like</em>) – The shape of array should be (n_samples, n_data_dim).
The output value that came out of the model.
Conditioning is done on this data. <span class="math notranslate nohighlight">\(P(para|data=obs)\)</span>.
Model parameters (para) and model outputs (data) indexes need to be aligned.</p></li>
<li><p><strong>para</strong> (<em>array-like</em>) – The shape of array should be (n_samples, n_para_dim).
Parameters used when outputting data from model.</p></li>
<li><p><strong>kernel</strong> (<em>class kernel</em>) – Specify an instance of kernel class as shown in Example.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em><em>, </em><em>optional</em>) – Regularization parameter. Defaults to 0.01.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Occurs when the number of samples of para and the number of samples of data do not match.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>[1] Fukumizu, K., Song, L., &amp; Gretton, A. (2013). Kernel Bayes’ rule: Bayesian inference with positive definite kernels. Journal of Machine Learning Research, 14, 3753–3783.
[2] Nakagome, S., Fukumizu, K., &amp; Mano, S. (2013). Kernel approximate Bayesian computation in population genetic inferences. Statistical Applications in Genetics and Molecular Biology, 12(6), 667–678. <a class="reference external" href="https://doi.org/10.1515/sagmb-2012-0050">https://doi.org/10.1515/sagmb-2012-0050</a></p>
</div>
<dl class="py method">
<dt id="nukernelmtd.KernelABC.conditioning">
<code class="sig-name descname">conditioning</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nukernelmtd.KernelABC.conditioning" title="Permalink to this definition">¶</a></dt>
<dd><p>[summary]
Compute conditional kernel with obs.
<span class="math notranslate nohighlight">\(m_P(para|data = obs)\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> (<em>array-like</em>) – The shape of array should be (n_samples, n_data_dim).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelABC.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nukernelmtd.KernelABC.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelABC.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#nukernelmtd.KernelABC.data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelABC.eap">
<em class="property">property </em><code class="sig-name descname">eap</code><a class="headerlink" href="#nukernelmtd.KernelABC.eap" title="Permalink to this definition">¶</a></dt>
<dd><p>Expected A Posteriori
<span class="math notranslate nohighlight">\(E_{\theta|Y_{obs}}[\theta] = &lt; m_{\theta}|Y_{obs} | \cdot &gt; = \sum_i w_i \theta_i\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelABC.epsilon">
<em class="property">property </em><code class="sig-name descname">epsilon</code><a class="headerlink" href="#nukernelmtd.KernelABC.epsilon" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelABC.gram">
<em class="property">property </em><code class="sig-name descname">gram</code><a class="headerlink" href="#nukernelmtd.KernelABC.gram" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelABC.k_obs">
<em class="property">property </em><code class="sig-name descname">k_obs</code><a class="headerlink" href="#nukernelmtd.KernelABC.k_obs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelABC.kernel">
<em class="property">property </em><code class="sig-name descname">kernel</code><a class="headerlink" href="#nukernelmtd.KernelABC.kernel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelABC.ndata">
<em class="property">property </em><code class="sig-name descname">ndata</code><a class="headerlink" href="#nukernelmtd.KernelABC.ndata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelABC.ndim_data">
<em class="property">property </em><code class="sig-name descname">ndim_data</code><a class="headerlink" href="#nukernelmtd.KernelABC.ndim_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelABC.ndim_para">
<em class="property">property </em><code class="sig-name descname">ndim_para</code><a class="headerlink" href="#nukernelmtd.KernelABC.ndim_para" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelABC.obs">
<em class="property">property </em><code class="sig-name descname">obs</code><a class="headerlink" href="#nukernelmtd.KernelABC.obs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelABC.para">
<em class="property">property </em><code class="sig-name descname">para</code><a class="headerlink" href="#nukernelmtd.KernelABC.para" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelABC.posterior_kernel_mean">
<code class="sig-name descname">posterior_kernel_mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kernel</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nukernelmtd.KernelABC.posterior_kernel_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>[summary]
Returns the posterior kernel mean of para which is class instance of KernelMean
:param kernel: Specify an instance of kernel class.</p>
<blockquote>
<div><p>para</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the class of kernel mean</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#nukernelmtd.kernel_mean.KernelMean" title="nukernelmtd.kernel_mean.KernelMean">KernelMean</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelABC.weights">
<em class="property">property </em><code class="sig-name descname">weights</code><a class="headerlink" href="#nukernelmtd.KernelABC.weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="nukernelmtd.KernelMean">
<em class="property">class </em><code class="sig-prename descclassname">nukernelmtd.</code><code class="sig-name descname">KernelMean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">kernel</span></em>, <em class="sig-param"><span class="n">weights</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nukernelmtd.KernelMean" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>[summary]
The class of Kernel Mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array-like</em><em> or </em><em>pandas dataframe</em>) – Sample for calculating kernel mean.
An array of shape should be (n_samples_x1, n_dim).</p></li>
<li><p><strong>kernel</strong> (<em>class kernel</em>) – Specify an instance of kernel class as shown in Example.</p></li>
<li><p><strong>weights</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Defaults to None.
Weight each sample when calculating the kernel mean.
By default, all samples are treated as equal weight.
Conditional kernel mean can be obtained by specifying the weights conditioned by kernel ABC.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_gauss</span> <span class="o">=</span> <span class="n">GaussKernel</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">],[</span><span class="mf">3.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernelmean</span> <span class="o">=</span> <span class="n">KernelMean</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">kernel</span><span class="o">=</span><span class="n">kernel_gauss</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">3</span><span class="p">],[</span><span class="o">-</span><span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">kernelmean</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">array([[0.00381482],</span>
<span class="go">       [0.048816  ],</span>
<span class="go">       [0.53921322],</span>
<span class="go">       [0.58062198],</span>
<span class="go">       [0.04522482]])</span>
</pre></div>
</div>
<dl class="py method">
<dt id="nukernelmtd.KernelMean.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nukernelmtd.KernelMean.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelMean.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#nukernelmtd.KernelMean.data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelMean.gradkde">
<code class="sig-name descname">gradkde</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">val</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nukernelmtd.KernelMean.gradkde" title="Permalink to this definition">¶</a></dt>
<dd><p>compute gradient of kernel density.
:param val: ndarray of shape (n_samples_val, n_dim).
:type val: ndarray
:param **kwargs: <em>kwargs</em> is used to specify the configuration for kernel mean calculation.</p>
<blockquote>
<div><dl class="simple">
<dt>normalize (bool, optional): Defaults to False.</dt><dd><p>Specify <cite>True</cite> when normalizing the kernel.
Some kernels do not have a normalization option, so see the kernel’s docstrings.</p>
</dd>
<dt>weights_normalize (bool, optional): Defaults to False.</dt><dd><p>Specify <cite>True</cite> when normalizing kernel average weighting.</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>return gradient value tensor.
ndarray of shape (n_samples_val, n_samples_data, n_dim).
Derivative value at val of kernel centered on data. dk(x,data)/dx (x=val).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>KV (ndarray)</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – If the gradient cannot be calculated, it returns the error.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelMean.kde">
<code class="sig-name descname">kde</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">val</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nukernelmtd.KernelMean.kde" title="Permalink to this definition">¶</a></dt>
<dd><p>compute kernel density
:param val: ndarray of shape (n_samples_val, n_dim).
:type val: ndarray
:param **kwargs: <em>kwargs</em> is used to specify the configuration for kernel mean calculation.</p>
<blockquote>
<div><dl class="simple">
<dt>normalize (bool, optional): Defaults to False.</dt><dd><p>Specify <cite>True</cite> when normalizing the kernel. Some kernels do not have a normalization option, so see the kernel’s docstrings.</p>
</dd>
<dt>weights_normalize (bool, optional): Defaults to False.</dt><dd><p>Specify <cite>True</cite> when normalizing kernel average weighting.</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>return kernel mean value. ndarray of shape (n_samples_val,n_samples_data).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>KV (ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelMean.kernel">
<em class="property">property </em><code class="sig-name descname">kernel</code><a class="headerlink" href="#nukernelmtd.KernelMean.kernel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelMean.n_samples">
<em class="property">property </em><code class="sig-name descname">n_samples</code><a class="headerlink" href="#nukernelmtd.KernelMean.n_samples" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="nukernelmtd.KernelMean.weights">
<em class="property">property </em><code class="sig-name descname">weights</code><a class="headerlink" href="#nukernelmtd.KernelMean.weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="nukernelmtd.data.html" class="btn btn-neutral float-right" title="nukernelmtd.data package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to nukernelmtd’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Yu Kiyokawa

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>